/* ----- Layout general ----- */
.chat-shell {
  display: flex;
  flex-direction: column;
  height: min(78vh, 760px);
  max-height: 90vh;
  max-width: 840px;
  margin: 16px auto;
  border-radius: 16px;
  overflow: hidden; /* recorta bordes redondeados */
}

/* Header */
.chat-header {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid rgba(0,0,0,0.06);
}

.chat-header .title {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
}

.chat-header mat-icon {
  font-size: 22px;
  width: 22px;
  height: 22px;
  opacity: 0.85;
}

/* ----- Historial ----- */
.history {
  position: relative;
  flex: 1 1 auto;
  padding: 16px 14px;
  overflow-y: auto;
  background:
    linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.00) 120px),
    var(--chat-bg, #fafafa);
}

/* Mensaje (contenedor) */
.msg {
  display: flex;
  margin: 8px 0;
}

/* Alineación me/other */
.msg.me {
  justify-content: flex-end;
}

.msg.other {
  justify-content: flex-start;
}

/* Burbuja */
.bubble {
  max-width: 76%;
  padding: 10px 12px;
  border-radius: 14px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.06);
  animation: pop 120ms ease-out;
}

/* Colores burbuja */
.msg.me .bubble {
  background: #1976d2;            /* Mat-Primary aprox (indigo/blue) */
  color: #fff;
  border-top-right-radius: 6px;
}

.msg.other .bubble {
  background: #ffffff;
  color: #222;
  border-top-left-radius: 6px;
  border: 1px solid rgba(0,0,0,0.06);
}

/* Meta (usuario y hora) */
.meta {
  display: flex;
  align-items: baseline;
  gap: 8px;
  margin-bottom: 4px;
  opacity: 0.9;
}

.meta b {
  font-weight: 600;
}

.meta .time {
  font-size: 0.78rem;
  opacity: 0.75;
}

/* Texto del mensaje */
.text {
  white-space: pre-wrap;
  word-wrap: break-word;
  line-height: 1.35;
}

/* ----- Composer (form) ----- */
.composer {
  display: grid;
  grid-template-columns: 1fr;
  gap: 8px;
  padding: 12px;
  border-top: 1px solid rgba(0,0,0,0.06);
  background: #fff;
}

.fw { width: 100%; }

/* Botón enviar dentro del mat-form-field */
.composer button[mat-icon-button] {
  transform: translateX(4px);
}

.composer button[mat-icon-button]:active {
  transform: translateX(4px) scale(0.95);
}

/* ----- Scrollbar sutil ----- */
.history::-webkit-scrollbar {
  width: 10px;
}
.history::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.15);
  border-radius: 8px;
}
.history::-webkit-scrollbar-track {
  background: transparent;
}

/* ----- Responsivo ----- */
@media (max-width: 640px) {
  .chat-shell {
    height: 82vh;
    margin: 8px;
    border-radius: 12px;
  }
  .bubble {
    max-width: 88%;
  }
}

/* ----- Modo oscuro amigable con Angular Material -----
   Si usás theming oscuro, estos colores acompañan bien. */
:host-context(.dark-theme) .history {
  --chat-bg: #121212;
  background: var(--chat-bg);
}
:host-context(.dark-theme) .chat-header {
  border-bottom-color: rgba(255,255,255,0.08);
}
:host-context(.dark-theme) .composer {
  background: #1a1a1a;
  border-top-color: rgba(255,255,255,0.08);
}
:host-context(.dark-theme) .msg.other .bubble {
  background: #1e1e1e;
  color: #eaeaea;
  border: 1px solid rgba(255,255,255,0.06);
}
:host-context(.dark-theme) .msg.me .bubble {
  background: #2196f3; /* un pelín más claro en dark */
  color: #fff;
}

/* ----- Micro animación ----- */
@keyframes pop {
  from {
    opacity: 0;
    transform: translateY(6px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
