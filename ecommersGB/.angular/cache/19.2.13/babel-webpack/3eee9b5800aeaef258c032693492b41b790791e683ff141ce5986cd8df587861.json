{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Nahuel/Documents/Proyectos/PAngular-master/PAngular-master/ecommersGB/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../servicios/auth.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nfunction LoginComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 9);\n    i0.…µ…µtext(1, \" \\u26A0\\uFE0F Ingres\\u00E1 un email v\\u00E1lido \");\n    i0.…µ…µelementEnd();\n  }\n}\nfunction LoginComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 9);\n    i0.…µ…µtext(1, \" \\u26A0\\uFE0F La contrase\\u00F1a es obligatoria \");\n    i0.…µ…µelementEnd();\n  }\n}\nfunction LoginComponent_p_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"p\", 9);\n    i0.…µ…µtext(1);\n    i0.…µ…µelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.…µ…µnextContext();\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate(ctx_r0.mensaje);\n  }\n}\nfunction LoginComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 10);\n    i0.…µ…µtext(1, \" \\u2705 Sesi\\u00F3n iniciada correctamente \");\n    i0.…µ…µelementEnd();\n  }\n}\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    fb;\n    auth;\n    router;\n    formulario;\n    mensaje = '';\n    mostrarToast = false;\n    cargando = false;\n    constructor(fb, auth, router) {\n      this.fb = fb;\n      this.auth = auth;\n      this.router = router;\n      this.formulario = this.fb.group({\n        email: ['', [Validators.required, Validators.email]],\n        password: ['', Validators.required]\n      });\n    }\n    campoInvalido(nombre) {\n      const c = this.formulario.get(nombre);\n      return !!c && c.invalid && (c.dirty || c.touched);\n    }\n    iniciarSesion() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        _this.mensaje = '';\n        if (_this.formulario.invalid) {\n          _this.formulario.markAllAsTouched();\n          return;\n        }\n        _this.cargando = true;\n        const {\n          email,\n          password\n        } = _this.formulario.value;\n        try {\n          const user = yield _this.auth.login(email, password);\n          _this.mostrarToast = true;\n          setTimeout(() => _this.mostrarToast = false, 2000);\n          // üî• Soluci√≥n 3: navegar siempre a /productos despu√©s del login\n          setTimeout(() => _this.router.navigate(['/productos']), 0);\n        } catch (err) {\n          console.error('Error de login (componente):', err?.code || err);\n          _this.mensaje = _this.mapError(err);\n        } finally {\n          _this.cargando = false;\n        }\n      })();\n    }\n    mapError(e) {\n      const code = e?.code || e?.error?.message;\n      switch (code) {\n        case 'auth/invalid-email':\n        case 'INVALID_EMAIL':\n          return 'El email no es v√°lido.';\n        case 'auth/missing-password':\n        case 'MISSING_PASSWORD':\n          return 'Ingres√° la contrase√±a.';\n        case 'auth/user-not-found':\n        case 'EMAIL_NOT_FOUND':\n          return 'No existe un usuario con ese email.';\n        case 'auth/wrong-password':\n        case 'INVALID_PASSWORD':\n          return 'Contrase√±a incorrecta.';\n        case 'auth/invalid-api-key':\n        case 'INVALID_API_KEY':\n          return 'API key inv√°lida en environment.';\n        default:\n          return 'No se pudo iniciar sesi√≥n. Revis√° los datos.';\n      }\n    }\n    static …µfac = function LoginComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || LoginComponent)(i0.…µ…µdirectiveInject(i1.FormBuilder), i0.…µ…µdirectiveInject(i2.AuthService), i0.…µ…µdirectiveInject(i3.Router));\n    };\n    static …µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n      type: LoginComponent,\n      selectors: [[\"app-login\"]],\n      decls: 16,\n      vars: 5,\n      consts: [[1, \"login-container\"], [3, \"ngSubmit\", \"formGroup\"], [\"for\", \"email\"], [\"id\", \"email\", \"type\", \"email\", \"formControlName\", \"email\"], [\"class\", \"error\", 4, \"ngIf\"], [\"for\", \"password\"], [\"id\", \"password\", \"type\", \"password\", \"formControlName\", \"password\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [\"class\", \"toast-exito\", 4, \"ngIf\"], [1, \"error\"], [1, \"toast-exito\"]],\n      template: function LoginComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.…µ…µelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.…µ…µtext(2, \"\\uD83D\\uDD10 Iniciar sesi\\u00F3n\");\n          i0.…µ…µelementEnd();\n          i0.…µ…µelementStart(3, \"form\", 1);\n          i0.…µ…µlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_3_listener() {\n            return ctx.iniciarSesion();\n          });\n          i0.…µ…µelementStart(4, \"label\", 2);\n          i0.…µ…µtext(5, \"Email:\");\n          i0.…µ…µelementEnd();\n          i0.…µ…µelement(6, \"input\", 3);\n          i0.…µ…µtemplate(7, LoginComponent_div_7_Template, 2, 0, \"div\", 4);\n          i0.…µ…µelementStart(8, \"label\", 5);\n          i0.…µ…µtext(9, \"Contrase\\u00F1a:\");\n          i0.…µ…µelementEnd();\n          i0.…µ…µelement(10, \"input\", 6);\n          i0.…µ…µtemplate(11, LoginComponent_div_11_Template, 2, 0, \"div\", 4);\n          i0.…µ…µelementStart(12, \"button\", 7);\n          i0.…µ…µtext(13, \"Ingresar\");\n          i0.…µ…µelementEnd()();\n          i0.…µ…µtemplate(14, LoginComponent_p_14_Template, 2, 1, \"p\", 4)(15, LoginComponent_div_15_Template, 2, 0, \"div\", 8);\n          i0.…µ…µelementEnd();\n        }\n        if (rf & 2) {\n          i0.…µ…µadvance(3);\n          i0.…µ…µproperty(\"formGroup\", ctx.formulario);\n          i0.…µ…µadvance(4);\n          i0.…µ…µproperty(\"ngIf\", ctx.campoInvalido(\"email\"));\n          i0.…µ…µadvance(4);\n          i0.…µ…µproperty(\"ngIf\", ctx.campoInvalido(\"password\"));\n          i0.…µ…µadvance(3);\n          i0.…µ…µproperty(\"ngIf\", ctx.mensaje);\n          i0.…µ…µadvance();\n          i0.…µ…µproperty(\"ngIf\", ctx.mostrarToast);\n        }\n      },\n      dependencies: [CommonModule, i4.NgIf, ReactiveFormsModule, i1.…µNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n      styles: [\".login-container[_ngcontent-%COMP%]{max-width:400px;margin:40px auto;padding:20px;background:#f9f9f9;border-radius:12px;box-shadow:0 0 10px #0000001a;font-family:Arial,sans-serif}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}label[_ngcontent-%COMP%]{display:block;margin-top:10px;font-weight:700}input[_ngcontent-%COMP%]{width:100%;padding:8px;margin-top:4px;border-radius:6px;border:1px solid #ccc}button[_ngcontent-%COMP%]{margin-top:20px;width:100%;padding:10px;background-color:#222;color:#fff;border:none;border-radius:6px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#000}.error[_ngcontent-%COMP%]{color:red;font-size:13px;margin-top:4px}.toast-exito[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;background-color:#28a745;color:#fff;padding:12px 20px;border-radius:6px;box-shadow:0 4px 12px #0003;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out;font-weight:700}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}\"]\n    });\n  }\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}